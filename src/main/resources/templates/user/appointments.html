<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<body>
<main layout:fragment="content">
    <div class="booking-container">
        <div class="booking-header d-flex align-items-center">
            <a href="/" class="text-white me-3 fs-5"><i class="fa-solid fa-arrow-left"></i></a>
            <h4 class="mb-0">Đặt lịch khám</h4>
        </div>

        <div class="booking-body">
            <!-- Chỉ báo các bước - Bước 1 được kích hoạt -->
            <div class="step-indicator mb-4">
                <div class="step active" id="step1">1. Chọn bác sĩ</div>
                <div class="step" id="step2">2. Chọn lịch khám</div>
                <div class="step" id="step3">3. Thông tin khám</div>
            </div>

            <!-- Nội dung Bước 1 -->
            <div id="doctorSelection" class="booking-step active">
                <!-- Ô tìm kiếm -->
                <div class="mb-3">
                    <div class="input-group">
                        <span class="input-group-text bg-white"><i class="fa-solid fa-magnifying-glass"></i></span>
                        <input type="text" class="form-control" placeholder="Tìm kiếm bác sĩ theo tên...">
                    </div>
                </div>

                <!-- Dropdown chọn chuyên khoa -->
                <div class="mb-4">
                    <select class="form-select" aria-label="Chọn chuyên khoa">
                        <option value="" selected>Tất cả chuyên khoa</option>
                        <option th:each="specialty : ${specialties}"
                                th:value="${specialty.id}"
                                th:text="${specialty.specialtyName}">
                            Khoa Tim Mạch
                        </option>
                    </select>
                </div>

                <!-- DANH SÁCH BÁC SĨ ĐỘNG -->
                <div class="row g-4" id="doctorList">

                    <!-- ======================================================= -->
                    <!-- BẮT ĐẦU: ÁP DỤNG LOGIC HIỂN THỊ TỪ ĐOẠN CODE 1 VÀO ĐÂY -->
                    <!-- ======================================================= -->

                    <!-- Vòng lặp th:each để lặp qua danh sách bác sĩ từ Controller -->
                    <div class="col-md-6 col-lg-4" th:each="doctor : ${doctors}">
                        <div class="card doctor-card h-100">

                            <!-- Dùng doctor.avatarUrl (Đúng, vì doctor là Doctor) -->
                            <img th:src="${doctor.avatarUrl != null and !doctor.avatarUrl.isEmpty()} ? @{/avatars/{fileName}(fileName=${doctor.avatarUrl})} : '...default.png'"
                                 class="card-img-top" alt="Ảnh bác sĩ">

                            <div class="card-body d-flex flex-column">
                                <!-- Dùng doctor.fullName (Đúng) -->
                                <h5 class="card-title fw-bold" th:text="${doctor.fullName}">...</h5>
                                <!-- Dùng doctor.specialization (Đúng) -->
                                <p class="card-text text-muted mb-3" th:text="${doctor.specialization}">...</p>

                                <!-- Dùng doctor.userAccount.id (Đúng) -->
                                <a th:href="@{/dat-lich/chon-lich(doctorId=${doctor.userAccount.id})}" class="btn btn-primary w-100 mt-auto">Chọn</a>
                            </div>
                        </div>
                    </div>

                    <!-- ======================================================= -->
                    <!-- KẾT THÚC: PHẦN HIỂN THỊ ĐỘNG -->
                    <!-- ======================================================= -->

                </div>
            </div>
        </div>
    </div>
</main>
</body>
</html>